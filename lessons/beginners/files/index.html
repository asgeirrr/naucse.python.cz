<!doctype html>
<html lang="cs">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <title>
            
                Soubory
            
        </title>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
        <link rel="stylesheet" href="/static/css/nausce.css">
        <link rel="stylesheet" href="/static/css/body.css">
        <link rel="stylesheet" href="/static/css/pygments-lovelace-style.css">
        

        
        

        <style>
            
    

        </style>
    </head>
    
    <body>
        
        <nav class="header">
            <ul class="container menu">
                <li><a href="/" class="logo"><h1>Nauč se Python!</h1></a></li>
                <li><a href="/courses/" class="menu-link"><h2>Materiály</h2></a></li>
                <li><a href="/runs/" class="menu-link"><h2>Kurzy</h2></a></li>
            </ul>
        </nav>
        

        
            <div class="content">
                <div class="alert alert-danger" role="alert">
                    Tato stránka je momentálně v rekonstrukci.
                    Pokud se chcete podílet na vylepšování těchto stránek,
                    navštivte repozitář na
                    <a href="https://github.com/pyvec/naucse.python.cz">GitHubu</a>.
                </div>
            </div>
        

        

<div class="page">
    <div class="container">

        

        
            <div class="slides row stuff">
                <section class="col-lg-12">
                    <section>
                        <h1>Soubory</h1>
                        <aside class="notes">
                            Dnes se podíváme na to, jak v Pythonu číst z
                            (a pak i zapisovat do) souborů.
                        </aside>
                        <aside class="notes">
                            K tomu jsou potřeba tři kroky:
                            <ol>
                                <li>soubor <em>otevřít</em>,</li>
                                <li>něco z něj <em>přečíst</em></li>
                                <li>a pak jej zase <em>zavřít</em>.</li>
                            </ol>
                        </aside>
                        <div>
                            Vytvoř si soubor <code>basnicka.txt</code>
                            napiš do něj libovolnou básničku,
                            a ulož jej s kódováním UTF-8.
                        </div>
                        <div class="note">
                            Na Windows budeš chtít použít kódování
                            „UTF-8 bez BOM”.
                            Na uložení souboru s básničkou doporučuji použít
                            stejný editor, jaký používáš na Pythoní programy.
                            Pokud musíš použít Notepad, pak v kódu použij místo
                            <code>'utf-8'</code> nestandardní
                            <code>'utf-8-sig'</code>.
                        </div>
                        <div>
                            Potom napiš tento program:
                        </div>
<pre>
soubor = open('basnicka.txt', encoding='utf-8')
obsah = soubor.read()
print(obsah)
soubor.close()
</pre>
                        <div>
                            a spusť ho z adresáře, ve kterém je
                            <code>basnicka.txt</code> (jinými slovy,
                            aktuální adsresář musí být ten, který
                            obsahuje ten soubor).
                        </div>
                        <div>
                            Obsah souboru se vypíše!
                        </div>
                    </section>
                    <section>
                        <h2>Iterace nad soubory</h2>
                        <aside class="notes">
                            Otevřené soubory se, jako např. řetězce či
                            <code>range</code>, dají použít s příkazem
                            <code>for</code>.
                            Například můžeme básničku odsadit,
                            aby se vyjímala v textu:
                        </aside>
<pre>
print('Slyšela jsem tuto básničku:')
print()
soubor = open('basnicka.txt', encoding='utf-8')
for radek in soubor:
    print('    ' + radek)
soubor.close()
print()
print('Jak se ti líbí?')
</pre>
                        <aside class="notes">
                            Když to zkusíš, zjistíš, že trochu nesedí
                            řádkování. Zkusíš vysvětlit, proč tomu tak je?
<details class="solution"><h3>Vysvětlení</h3>
Každý řádek končí znakem nového řádku (<code>'\n'</code>).
Při procházení souboru Python tento znak nechává na konci řetězce
<code>radek</code> ¹.
Funkce <code>print</code> pak přidá další nový řádek, protože ta na konci
výpisu vždycky odřádkovává – pokud nedostane argument <code>end=''</code>.
To je jeden způso jak řádkování „spravit“; další je použít metodu
<code>rstrip</code>, která odstraní mezery a nové řádky z konce řetězce.

<div class="note"><small>
¹ Proč to dělá? Kdyby <code>'\n'</code> na konci řádků nebylo,
nedalo by se např. dobře rozlišit jestli poslední řádek
končí na <code>'\n'</code>.
</small></div>
</details>
                        </aside>
                    </section>
                    <section>
                        <h2>Zavírání souborů</h2>
                        <aside class="notes">
                            Je docela důležité soubory potom, co s nimi
                            přestaneme pracovat, zavřít
                            (pomocí metody <code>close()</code>).
                            Operační systémy mají limity na počet
                            současně otevřených souborů, které se nezavíráním
                            dají snadno překročit.
                            Na Windows navíc nemůžeš soubor, který je stále
                            otevřený, otevřít znovu.
                        </aside>
                        <aside class="notes">
                            Soubory se dají přirovnat k ledničce: abychom něco
                            mohly z ledničky vzít, nebo dát dovnitř, musíme
                            ji napřed otevřít, a nakonec zavřít.
                            Bez zavření to sice na první pohled funguje taky,
                            ale pravděpodobně potom brzo něco zplesniví.
                        </aside>
                        <aside class="notes">
                            Zapomenout zavřít soubor je docela jednoduché:
                            například pokud by v rámci zpracování souboru
                            nastane výjimka nebo kdybys vyskočila z funkce
                            pomocí <code>return</code>, náš předchozí
                            kód by <code>close</code> nezavolal,
                            a soubor by zůstal otevřený.
                        </aside>
                        <aside class="notes">
                            K tomu, abychom soubor nezapomněly v podobných
                            příkazech zavřít, slouží příkaz
                            <code>try/finally</code>, který jsme si ukázaly
                            v souvislosti s výjimkami.
                        </aside>
                        <aside class="notes">
                            Pro připomenutí, <code>finally</code> se provede
                            vždycky – i po vrácení z funkce.
                        </aside>
<pre>
def iniciala():
    soubor = open('basnicka.txt', encoding='utf-8')
    try:
        obsah = soubor.read()
        return obsah[0]
    finally:
        soubor.close()
print(iniciala())
</pre>
                        <aside class="notes">
                            Blok <code>finally</code> se dá v praxi použít vždycky,
                            když je potřeba něco ukončit nebo zavřít – ať už
                            je to soubor, nebo třeba připojení k databázi.
                        </aside>
                    </section>
                    <section>
                        <h2>Příkaz with</h2>
                        <aside class="notes">
                            Protože je <code>try/finally</code>
                            dlouhé a nepohodlné, má Python i příjemnější
                            variantu, příkaz <code>with</code>:
                        </aside>
<pre>
def iniciala():
    with open('basnicka.txt', encoding='utf-8') as soubor:
        obsah = soubor.read()
        return obsah[0]
print(iniciala())
</pre>
                        <aside class="notes">
                            Tenhle příkaz jsme už viděly u testování,
                            kde uvozoval blok, ve kterém má nastat výjimka –
                            potom, co blok skončí, se zkontroluje jestli
                            nastala a jestli je toho správného typu.
                            V našem případě se po skončení bloku
                            zavře soubor, ať už výjimka nastala nebo ne.
                        </aside>
                        <aside class="notes">
                            V naprosté většině příkazů je pro práci se soubory
                            nejlepší použít <code>with</code>.
                        </aside>
                    </section>
                    <section>
                        <h2>Psaní souborů</h2>
                        <aside class="notes">
                            Soubory se v Pythonu dají i zapisovat.
                            Pro zápis se soubor otevře pomocí pojmenovaného
                            argumentu <code>mode='w'</code> (z angl.
                            <em>mode</em>, mód a <em>write</em>, psát).
                            Zapisovat jednotlivé řetězce se pak dá metodou
                            <code>write</code>.
                        </aside>
                        <aside class="notes">
                            Pozor na to, že pokud soubor už existuje, otevření
                            pro zápis jej bez milosti přepíše.
                        </aside>
                        <aside class="notes">
                            A taky nezapomeň ukončovat řádky – Python to za
                            tebe neudělá, <code>'\n'</code> je potřeba
                            přidávat „ručně“.
                        </aside>
<pre>
with open('basnicka.txt', mode='w', encoding='utf-8') as soubor:
    soubor.write('Naše staré hodiny\n')
    soubor.write('Bijí čtyři hodiny\n')
</pre>
                    </section>
                </section>
            </div>
        

        <hr class="lesson-end">

        

        

    </div>
</div>



        <script type="text/javascript" src="/static/js/solutions.js"></script>

        
        <div class="footer">
            <div class="container">
                <div class="row">
                    <div class="col">
                        <h2>Kontakt</h2>
                        <p>
                            E-mail: <a href="mailto:info@pyvec.org">info@pyvec.org</a><br>
                            GitHub: <a href="http://github.com/pyvec">github.com/pyvec</a><br>
                            Twitter: <a href="http://twitter.com/pyvec">@pyvec</a><br>
                            Youtube: <a href="http://www.youtube.com/pyvec">www.youtube.com/pyvec</a>
                        </p>
                    </div>
                    <div class="col">
                        <h2>Zapoj se</h2>
                        <p>
                            Tyto stránky na <a href="https://github.com/pyvec/naucse.python.cz">GitHubu</a>
                            <br>
                            Organizuj <a href="http://pyladies.cz/stan_se/">PyLadies</a>
                        </p>
                    </div>
                    <div class="col">
                        <h2>Licence</h2>
                        <p>
                            <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
        
        
        <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>

    </body>
</html>